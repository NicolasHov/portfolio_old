<!DOCTYPE html>
<html>
  <head>

    <title>Map</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

  </head>

  <body>

    <div id="organismeformation"></div>

    <script>
        
        if(self.fetch) {
        // exécuter ma requête fetch :
        var myHeaders = new Headers();

        var myInit = { method: 'GET',
                    headers: myHeaders,
                    mode: 'cors',
                    cache: 'default' };

        fetch('flowers.jpg',myInit).then(function(response) {
        if(response.ok) {
            response.blob().then(function(myBlob) {
            var objectURL = URL.createObjectURL(myBlob);
            myImage.src = objectURL;
            });
        } else {
            console.log('Mauvaise réponse du réseau');
        }
        })
        .catch(function(error) {
        console.log('Il y a eu un problème avec l\'opération fetch: ' + error.message);
        });

        } else {
        // si pas fetch, faire quelque chose avec XMLHttpRequest

            function ajaxGet(url, callback) {
                var req = new XMLHttpRequest();
                
                req.open("GET", url);
                req.addEventListener("load", function () {
                    if (req.status >= 200 && req.status < 400) {
                        // Appelle la fonction callback en lui passant la réponse de la requête
                        callback(req.responseText);
                    } else {
                        console.error(req.status + " " + req.statusText + " " + url);
                    }
                });
                req.addEventListener("error", function () {
                    console.error("Erreur réseau avec l'URL " + url);
                });
                req.send(null);
            }
            
            var OF_elt = document.getElementById("organismeformation");

            ajaxGet("https://whispering-waters-52030.herokuapp.com/of/", function (reponse) {

                var organismeformation = JSON.parse(reponse);
            
                var nameElt = document.createElement("p");

                nameElt.textContent = organismeformation.name;

                OF_elt.appendChild(nameElt);
            });
        }
    </script>


    </body>
</html>